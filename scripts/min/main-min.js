function distance(e,r){var n=0,t;for(t=0;t<e.length;t++)n+=Math.pow(e[t]-r[t],2);return Math.sqrt(n)}function isAfter(e,r){return r[0]>e[0]?!0:r[0]===e[0]&&r[1]>e[1]?!0:!1}function getNextTime(e,r){for(var n in r)if(r.hasOwnProperty(n)&&isAfter(e,r[n])===!0)return r[n];return-1}function convertTo12(e){var r=e[0],n="AM";return r>=12&&(n="PM",r>12&&(r-=12,n="PM",24===r&&(n="AM",r>24&&(r-=12)))),[r,e[1],n]}function generateDivs(e){for(var r in places)if(places.hasOwnProperty(r)){var n=document.createElement("div");n.className="block",r===e&&(n.id="chosen");var t=document.createElement("span");t.className="name";var o=document.createElement("span");o.className="time",t.innerHTML=places[r][0]+" ";var i=getNextTime(currentTime,places[r][2]);if(-1===i)o.innerHTML="Out of luck!";else{var a=convertTo12(i);o.innerHTML=a[0]+":"+a[1]+a[2]}n.appendChild(t),n.appendChild(o),timeDiv.appendChild(n)}return-1}function showPosition(e){var r=[e.coords.latitude,e.coords.longitude],n=Number.MAX_SAFE_INTEGER,t=Number.MAX_SAFE_INTEGER;for(var o in places)if(places.hasOwnProperty(o)){var i=distance(r,places[o][1]);n>i&&(n=i,t=o)}generateDivs(o)}function showError(e){switch(e.code){case e.PERMISSION_DENIED:errorDiv.innerText="User denied the request for Geolocation.";break;case e.POSITION_UNAVAILABLE:errorDiv.innerHTML="Location information is unavailable.";break;case e.TIMEOUT:errorDiv.innerHTML="The request to get user location timed out.";break;case e.UNKNOWN_ERROR:errorDiv.innerHTML="An unknown error occurred."}generateDivs(-1)}function getLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition,showError):(errorDiv.innerHTML="Geolocation is not supported by this browser.",generateDivs(-1))}var timeDiv=document.getElementById("times"),errorDiv=document.getElementById("error"),date=new Date,currentTime=[date.getHours(),date.getMinutes()],times_gleason=[[7,25],[7,42],[7,59],[8,16],[8,33],[8,50],[9,7],[9,24],[9,41],[9,58],[10,15],[10,32],[10,49],[11,6],[11,23],[11,40],[11,57],[12,14],[12,31],[12,48],[13,5],[13,22],[13,39],[13,56],[14,13],[14,30],[14,47],[15,4],[15,21],[15,38],[15,55],[16,12],[18,5],[18,30],[18,55],[19,20],[19,45],[20,10],[20,35],[21,0],[21,25],[21,50],[22,15],[22,40],[23,5],[23,30],[23,55],[24,20],[24,45],[25,10],[25,35]],times_province=[[7,18],[7,35],[7,52],[8,9],[8,26],[8,43],[9,0],[9,17],[9,34],[9,51],[10,8],[10,25],[10,42],[10,59],[11,16],[11,33],[11,50],[12,7],[12,24],[12,41],[12,58],[13,15],[13,32],[13,49],[14,6],[14,23],[14,40],[14,57],[15,14],[15,31],[15,48],[16,5],[18,19],[18,44],[19,9],[19,34],[19,59],[20,24],[20,49],[21,14],[21,39],[22,4],[22,29],[22,54],[23,19],[23,44],[24,9],[24,34],[24,59],[25,24]],province=["The Province",[43.086581,-77.656322],times_province],gleason=["Gleason Circle",[43.08295,-77.675816],times_gleason],places=[province,gleason];getLocation();